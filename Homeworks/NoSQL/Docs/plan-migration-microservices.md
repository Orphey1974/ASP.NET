# –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–Ω–æ–ª–∏—Ç–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –Ø–Ω–¥–µ–∫—Å.–¢–∞–∫—Å–∏)

## –í–≤–µ–¥–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ—à–∞–≥–æ–≤—É—é –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –∫—Ä—É–ø–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –Ø–Ω–¥–µ–∫—Å.–¢–∞–∫—Å–∏) —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –º–æ–Ω–æ–ª–∏—Ç–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –∞–Ω–∞–ª–∏–∑–æ–º –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞, —Å—Ö–µ–º–∞–º–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strangler –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

---

## 0. –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –Ø–Ω–¥–µ–∫—Å.–¢–∞–∫—Å–∏:**  
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∑–∞–∫–∞–∑–∞ —Ç–∞–∫—Å–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤, —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏, –ø–æ–¥–±–æ—Ä–∞ –≤–æ–¥–∏—Ç–µ–ª—è, –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–ö–ª—é—á–µ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ —Ç–∞—Ä–∏—Ñ).
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
3. –ü–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
4. –°—Ç—Ä–æ–∏—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Ü–µ–Ω–∞.
5. –ü–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–¥—Ö–æ–¥—è—â–∏–π –≤–æ–¥–∏—Ç–µ–ª—å.
6. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞.
7. –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push/SMS-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±–µ–∏–º —Å—Ç–æ—Ä–æ–Ω–∞–º.

---

## 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

| –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å         | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                      | –•—Ä–∞–Ω–∏–ª–∏—â–µ              |
|---------------------|------------------------------------------------|------------------------|
| UserService         | –ü—Ä–æ—Ñ–∏–ª–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è           | PostgreSQL             |
| DriverService       | –ü—Ä–æ—Ñ–∏–ª–∏ –∏ —Å—Ç–∞—Ç—É—Å –≤–æ–¥–∏—Ç–µ–ª–µ–π                      | PostgreSQL             |
| OrderService        | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏              | PostgreSQL + MongoDB   |
| TariffRouteService  | –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Ä–∞—Å—á–µ—Ç —Ç–∞—Ä–∏—Ñ–∞             | Redis + PostgreSQL     |
| PaymentService      | –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –∏ —É—á—ë—Ç –ø–ª–∞—Ç–µ–∂–µ–π                      | PostgreSQL             |
| NotificationService | –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –∫–∞–Ω–∞–ª–∞–º                 | MongoDB                |
| LocationService     | Real-time –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–≤–æ–¥–∏—Ç–µ–ª–µ–π    | Redis + TimescaleDB    |
| MatchingService     | –ü–æ–¥–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è –ø–æ –∑–∞–∫–∞–∑—É          | Redis                  |

---

## 2. –°—Ü–µ–Ω–∞—Ä–∏–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

| –®–∞–≥ | –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä             | –ü–æ–ª—É—á–∞—Ç–µ–ª—å            | –û–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è                           | –°–ø–æ—Å–æ–± –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è | –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ                        | –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç                |
|-----|-----------------------|-----------------------|---------------------------------------------|-----------------------|--------------------------------------------|--------------------------------|
| 1   | –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | API Gateway           | –ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞                   | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (REST/HTTP)| userId, pickupLocation, dropoffLocation, tariffType | orderId, status, estimatedCost |
| 2   | API Gateway           | UserService           | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞           | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (gRPC)     | userId, authToken                          | userProfile, isActive          |
| 3   | API Gateway           | LocationService       | –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç                 | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (gRPC)     | userId                                     | latitude, longitude, accuracy  |
| 4   | OrderService          | TariffRouteService    | –ó–∞–ø—Ä–æ—Å —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏         | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (REST/HTTP)| pickupCoords, dropoffCoords, tariffType    | route, distance, duration, cost|
| 5   | OrderService          | MatchingService       | –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–∏—Å–∫ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è         | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (Kafka)   | orderId, location, tariffType              | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ      |
| 6   | OrderService          | NotificationService   | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞               | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (RabbitMQ)| orderId, userId, status                    | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ      |
| 7   | MatchingService       | DriverService         | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤–æ–¥–∏—Ç–µ–ª–µ–π     | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (gRPC)     | location, radius, tariffType               | List<driverId>, availability   |
| 8   | OrderService          | PaymentService        | –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞         | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (REST/HTTP)| orderId, userId, amount                    | paymentStatus, transactionId   |
| 9   | OrderService          | NotificationService   | –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –≤–æ–¥–∏—Ç–µ–ª—è  | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (RabbitMQ)| orderId, driverId, userId, ETA             | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ      |
| 10  | NotificationService   | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–í–æ–¥–∏—Ç–µ–ª—å | –î–æ—Å—Ç–∞–≤–∫–∞ Push/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π               | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (FCM/APNS)| message, deviceToken                       | deliveryStatus                 |

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (Mermaid –¥–∏–∞–≥—Ä–∞–º–º–∞):

```mermaid
sequenceDiagram
    participant Client
    participant API_GW as API Gateway
    participant UserS as UserService
    participant LocationS as LocationService
    participant OrderS as OrderService
    participant TariffS as TariffRouteService
    participant MatchS as MatchingService
    participant DriverS as DriverService
    participant PayS as PaymentService
    participant NotifS as NotificationService

    Client->>API_GW: 1. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (REST)
    API_GW->>UserS: 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (gRPC)
    UserS-->>API_GW: userProfile, isActive
    API_GW->>LocationS: 3. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (gRPC)
    LocationS-->>API_GW: lat, lon, accuracy
    API_GW->>OrderS: –ü–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
    OrderS->>TariffS: 4. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç –∏ —Ü–µ–Ω—É (REST)
    TariffS-->>OrderS: route, cost, duration
    OrderS-->>MatchS: 5. –ü–æ–∏—Å–∫ –≤–æ–¥–∏—Ç–µ–ª—è (Kafka, async)
    MatchS->>DriverS: 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–π (gRPC)
    DriverS-->>MatchS: List<driverId>
    OrderS->>PayS: 8. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞ (REST)
    PayS-->>OrderS: paymentStatus, txnId
    OrderS-->>NotifS: 6,9. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (RabbitMQ, async)
    NotifS-->>Client: 10. Push/SMS (FCM/APNS)
```

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**
- üîµ –°–ø–ª–æ—à–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ (`->>`, `-->>`) ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã (REST, gRPC)
- üü† –ü—É–Ω–∫—Ç–∏—Ä–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ (`-->>`) —Å async ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ (Kafka, RabbitMQ)

---

## 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strangler (OrderService ‚Üí TariffRouteService)

### 3.1. –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strangler

–ü–∞—Ç—Ç–µ—Ä–Ω Strangler (–£–¥—É—à–µ–Ω–∏–µ) –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–Ω–æ–ª–∏—Ç–∞ –Ω–æ–≤—ã–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º—ã. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ñ–∞—Å–∞–¥ (API Gateway), –∫–æ—Ç–æ—Ä—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –ª–∏–±–æ –≤ —Å—Ç–∞—Ä—ã–π –º–æ–Ω–æ–ª–∏—Ç, –ª–∏–±–æ –≤ –Ω–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ Feature Toggle.

### 3.2. –≠—Ç–∞–ø—ã –º–∏–≥—Ä–∞—Ü–∏–∏

| –§–∞–∑–∞ | –î–µ–π—Å—Ç–≤–∏–µ                                       | –†–µ–∑—É–ª—å—Ç–∞—Ç                                           | –°—Ä–æ–∫      |
|------|------------------------------------------------|-----------------------------------------------------|-----------|
| 1    | –ê–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ                          | –í—ã–¥–µ–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏: —Ä–∞—Å—á–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞, —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ | 1 –Ω–µ–¥–µ–ª—è  |
| 1    | –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –º–æ–Ω–æ–ª–∏—Ç–µ                 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–≤—è–∑–∏ —Å OrderService, LocationService    | 1 –Ω–µ–¥–µ–ª—è  |
| 1    | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü –Ω–æ–≤–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞         | –û–ø—Ä–µ–¥–µ–ª–µ–Ω API –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞               | 1 –Ω–µ–¥–µ–ª—è  |
| 2    | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–∫—Å–∏-—Å–ª–æ—è (Strangler Facade)      | API Gateway –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ –º–æ–Ω–æ–ª–∏—Ç –∏–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å | 2 –Ω–µ–¥–µ–ª–∏ |
| 2    | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤               | –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ Feature Flag        | 1 –Ω–µ–¥–µ–ª—è  |
| 2    | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Feature Toggle –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è     | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è                | 1 –Ω–µ–¥–µ–ª—è  |
| 3    | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ TariffRouteService (—Ä–∞—Å—á–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞)| –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å —Ä–∞—Å—á–µ—Ç–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞          | 3 –Ω–µ–¥–µ–ª–∏  |
| 3    | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Ç–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏             | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–∞—Ä–∏—Ñ–Ω–æ–π —Å–µ—Ç–∫–æ–π                        | 2 –Ω–µ–¥–µ–ª–∏  |
| 3    | –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ç–∞—Ä–∏—Ñ–∞—Ö                      | –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ PostgreSQL + Redis –∫—ç—à          | 1 –Ω–µ–¥–µ–ª—è  |
| 4    | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å—Ç–∞—Ä–æ–≥–æ –∏ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞      | 10% —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å, –æ—Å—Ç–∞–ª—å–Ω–æ–µ - –º–æ–Ω–æ–ª–∏—Ç    | 2 –Ω–µ–¥–µ–ª–∏  |
| 4    | A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥                  | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏                 | 1 –Ω–µ–¥–µ–ª—è  |
| 5    | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ –º–æ–Ω–æ–ª–∏—Ç–∞          | –ö–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞ —É–¥–∞–ª–µ–Ω –∏–∑ OrderService         | 1 –Ω–µ–¥–µ–ª—è  |
| 5    | –ü–æ–ª–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å             | 100% —Ç—Ä–∞—Ñ–∏–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç TariffRouteService        | 1 –Ω–µ–¥–µ–ª—è  |

### 3.3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è Strangler Pattern (Mermaid)

```mermaid
flowchart TD
  subgraph Phase1["–î–æ –º–∏–≥—Ä–∞—Ü–∏–∏"]
    C1[Client] --> GW1[API Gateway]
    GW1 --> M1[OrderService –ú–æ–Ω–æ–ª–∏—Ç<br/>—Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É —Ç–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏]
  end
  
  subgraph Phase2["–í–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏ - Strangler Facade"]
    C2[Client] --> GW2[API Gateway/Facade<br/>Feature Toggle]
    GW2 -->|90% —Ç—Ä–∞—Ñ–∏–∫–∞| M2[OrderService –ú–æ–Ω–æ–ª–∏—Ç<br/>—Å—Ç–∞—Ä—ã–π –∫–æ–¥]
    GW2 -.->|10% —Ç—Ä–∞—Ñ–∏–∫–∞| T2[TariffRouteService<br/>–Ω–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å]
  end
  
  subgraph Phase3["–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏"]
    C3[Client] --> GW3[API Gateway]
    GW3 --> N3[OrderService<br/>–±–µ–∑ –ª–æ–≥–∏–∫–∏ —Ç–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏]
    N3 --> T3[TariffRouteService<br/>–≤—Å—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞]
    M3[–°—Ç–∞—Ä—ã–π –º–æ–Ω–æ–ª–∏—Ç<br/>Deprecated/Removed]
    style M3 fill:#ffcccc,stroke:#e67e22,stroke-width:2px
  end
  
  style T2 fill:#d4edda,stroke:#28a745
  style T3 fill:#d4edda,stroke:#28a745
  style M1 fill:#fff3cd,stroke:#ffc107
  style M2 fill:#fff3cd,stroke:#ffc107
```

### 3.4. –ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### 3.4.1. API Gateway —Å Feature Toggle (C# .NET)

```csharp
// API Gateway —Å Feature Toggle –¥–ª—è Strangler Pattern
// –§—Ä–∞–≥–º–µ–Ω—Ç –∫–ª–∞—Å—Å–∞ TariffRouteFacade

public class TariffRouteFacade
{
    private readonly IMonolithOrderService _monolithService;
    private readonly ITariffRouteService _newMicroservice;
    private readonly IFeatureToggle _featureToggle;
    private readonly ILogger<TariffRouteFacade> _logger;

    public async Task<TariffCalculationResponse> CalculateRouteAndPrice(
        TariffCalculationRequest request)
    {
        try
        {
            // Feature Toggle –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
            bool useNewService = await _featureToggle
                .IsEnabledAsync("UseTariffRouteMicroservice", request.UserId);

            if (useNewService)
            {
                _logger.LogInformation(
                    "Routing to new TariffRouteService for user {UserId}", 
                    request.UserId);
                    
                return await _newMicroservice.CalculateRouteAndPriceAsync(request);
            }
            else
            {
                _logger.LogInformation(
                    "Routing to monolith OrderService for user {UserId}", 
                    request.UserId);
                    
                return await _monolithService.CalculateRouteAndPriceAsync(request);
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error calculating route and price");
            
            // Fallback –Ω–∞ –º–æ–Ω–æ–ª–∏—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
            if (useNewService)
            {
                _logger.LogWarning("Falling back to monolith");
                return await _monolithService.CalculateRouteAndPriceAsync(request);
            }
            
            throw;
        }
    }
}

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Feature Toggle
public class FeatureToggleConfig
{
    public bool Enabled { get; set; }
    public int PercentageRollout { get; set; } // 0-100
    public List<string> WhitelistedUserIds { get; set; }
}
```

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `Feature Toggle` –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –º–æ–Ω–æ–ª–∏—Ç–æ–º –∏ –Ω–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–æ–º
- `PercentageRollout` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ (–∫–∞–Ω–∞—Ä–µ–µ—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- `Fallback` –º–µ—Ö–∞–Ω–∏–∑–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### 3.4.2. –ù–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å TariffRouteService (C# .NET Core)

```csharp
// TariffRouteService - –Ω–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
// –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Ç–∞—Ä–∏—Ñ–∞

[ApiController]
[Route("api/v1/tariff-route")]
public class TariffRouteController : ControllerBase
{
    private readonly ITariffCalculator _tariffCalculator;
    private readonly IRouteOptimizer _routeOptimizer;
    private readonly IDistributedCache _cache;

    [HttpPost("calculate")]
    public async Task<ActionResult<TariffCalculationResponse>> Calculate(
        [FromBody] TariffCalculationRequest request)
    {
        var cacheKey = $"route:{request.PickupLocation}:{request.DropoffLocation}";
        
        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
        var cachedResult = await _cache.GetStringAsync(cacheKey);
        if (cachedResult != null)
        {
            return JsonSerializer.Deserialize<TariffCalculationResponse>(cachedResult);
        }

        // 2. –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
        var route = await _routeOptimizer.CalculateOptimalRoute(
            request.PickupLocation,
            request.DropoffLocation
        );

        // 3. –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞—Ä–∏—Ñ–∞
        var price = await _tariffCalculator.CalculatePrice(
            route.Distance,
            route.EstimatedDuration,
            request.TariffType,
            DateTime.Now // —É—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (—á–∞—Å –ø–∏–∫)
        );

        var response = new TariffCalculationResponse
        {
            Route = route,
            Price = price,
            EstimatedDuration = route.EstimatedDuration,
            Distance = route.Distance
        };

        // 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –∫—ç—à (15 –º–∏–Ω—É—Ç)
        await _cache.SetStringAsync(
            cacheKey,
            JsonSerializer.Serialize(response),
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(15)
            }
        );

        return Ok(response);
    }
}

// –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
public class TariffCalculationRequest
{
    public string UserId { get; set; }
    public GeoCoordinate PickupLocation { get; set; }
    public GeoCoordinate DropoffLocation { get; set; }
    public TariffType TariffType { get; set; }
}

public class TariffCalculationResponse
{
    public RouteInfo Route { get; set; }
    public decimal Price { get; set; }
    public TimeSpan EstimatedDuration { get; set; }
    public double Distance { get; set; }
}
```

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Redis` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É `RouteOptimizer` –∏ `TariffCalculator` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å
- –£—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (—á–∞—Å –ø–∏–∫, —Å–ø—Ä–æ—Å) –≤ `TariffCalculator`
- RESTful API —É–ø—Ä–æ—â–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –¥—Ä—É–≥–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏

### 3.5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (OpenAPI/Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è)

```yaml
openapi: 3.0.0
info:
  title: TariffRouteService API
  version: 1.0.0
  description: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–∫–∏

servers:
  - url: https://api.yandex-taxi.ru/tariff-route/v1
    description: Production server

paths:
  /calculate:
    post:
      summary: –†–∞—Å—á–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–µ–∑–¥–∫–∏
      operationId: calculateRouteAndPrice
      tags:
        - Tariff Calculation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TariffCalculationRequest'
            example:
              userId: "user123"
              pickupLocation:
                latitude: 55.751244
                longitude: 37.618423
              dropoffLocation:
                latitude: 55.755826
                longitude: 37.617300
              tariffType: "Economy"
      responses:
        '200':
          description: –£—Å–ø–µ—à–Ω—ã–π —Ä–∞—Å—á–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TariffCalculationResponse'
              example:
                route:
                  points: 
                    - { latitude: 55.751244, longitude: 37.618423 }
                    - { latitude: 55.755826, longitude: 37.617300 }
                  distance: 8.5
                  estimatedDuration: "PT15M"
                price: 450.50
                estimatedDuration: "PT15M"
                distance: 8.5
        '400':
          description: –ù–µ–≤–µ—Ä–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid coordinates"
        '500':
          description: –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

components:
  schemas:
    TariffCalculationRequest:
      type: object
      required:
        - userId
        - pickupLocation
        - dropoffLocation
        - tariffType
      properties:
        userId:
          type: string
          example: "user123"
        pickupLocation:
          $ref: '#/components/schemas/GeoCoordinate'
        dropoffLocation:
          $ref: '#/components/schemas/GeoCoordinate'
        tariffType:
          type: string
          enum: [Economy, Comfort, Business, Premium]
          example: "Economy"

    TariffCalculationResponse:
      type: object
      properties:
        route:
          $ref: '#/components/schemas/RouteInfo'
        price:
          type: number
          format: decimal
          example: 450.50
        estimatedDuration:
          type: string
          format: duration
          example: "PT15M"
        distance:
          type: number
          format: double
          example: 8.5

    GeoCoordinate:
      type: object
      required:
        - latitude
        - longitude
      properties:
        latitude:
          type: number
          format: double
          minimum: -90
          maximum: 90
          example: 55.751244
        longitude:
          type: number
          format: double
          minimum: -180
          maximum: 180
          example: 37.618423

    RouteInfo:
      type: object
      properties:
        points:
          type: array
          items:
            $ref: '#/components/schemas/GeoCoordinate'
        distance:
          type: number
          format: double
          description: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
        estimatedDuration:
          type: string
          format: duration
          description: –û—Ü–µ–Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ API:**
- –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenAPI —Å—Ö–µ–º—É –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ —É–ø—Ä–æ—â–∞—é—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—à–∏—Ä–æ—Ç–∞: -90..90, –¥–æ–ª–≥–æ—Ç–∞: -180..180)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ISO 8601 –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (PT15M = 15 –º–∏–Ω—É—Ç)

---

## 4. –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strangler

### 4.1. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Ü–µ–Ω–∫–∏              | –ú–æ–Ω–æ–ª–∏—Ç (–¥–æ)                  | Big Bang –º–∏–≥—Ä–∞—Ü–∏—è             | Strangler Pattern                     | –û—Ü–µ–Ω–∫–∞ (1-10)                           |
|------------------------------|-------------------------------|-------------------------------|---------------------------------------|-----------------------------------------|
| **–†–∏—Å–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏**           | –ù–∏–∑–∫–∏–µ (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)   | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–µ                 | –ù–∏–∑–∫–∏–µ (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)         | 9/10 - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏                |
| **–í—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è —Å–∏—Å—Ç–µ–º—ã**    | –ù–µ—Ç (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞)    | –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ (–¥–Ω–∏/–Ω–µ–¥–µ–ª–∏)     | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞)      | 10/10 - zero downtime                   |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è**      | –ù–∏–∑–∫–∞—è (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)      | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è                 | –°—Ä–µ–¥–Ω—è—è (—Ç—Ä–µ–±—É–µ—Ç —Ñ–∞—Å–∞–¥–∞)              | 7/10 - —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã |
| **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞**       | –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è                  | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω        | –ü—Ä–æ—Å—Ç–æ–π (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞)          | 10/10 - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç                |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**     | –ù–∏–∑–∫–∞—è (–ø–æ–¥–¥–µ—Ä–∂–∫–∞)            | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è                 | –°—Ä–µ–¥–Ω—è—è (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è)             | 8/10 - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏          |
| **–°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á** | –ù–∏–∑–∫–∞—è (–¥–æ–ª–≥–∏–µ —Ä–µ–ª–∏–∑—ã)     | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏  | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ                 | 8/10 - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É          |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è)   | –í—ã—Å–æ–∫–∞—è –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏        | –í—ã—Å–æ–∫–∞—è (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ) | 10/10 - –ø–æ–ª–Ω–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å            |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**       | –°—Ä–µ–¥–Ω—è—è (—É–∑–∫–∏–µ –º–µ—Å—Ç–∞)         | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è (—Ä–∏—Å–∫ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏) | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ                 | 9/10 - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ         |
| **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**            | –ù–∏–∑–∫–æ–µ (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥)     | –í—ã—Å–æ–∫–æ–µ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏        | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ                 | 9/10 - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–∞–ª—ã–º–∏ —à–∞–≥–∞–º–∏        |
| **–£–¥–æ–±—Å—Ç–≤–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**    | –°–ª–æ–∂–Ω–æ–µ (—Ç–µ—Å–Ω–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å)    | –°–ª–æ–∂–Ω–æ–µ (–≤—Å—ë —Å—Ä–∞–∑—É)           | –£–ø—Ä–æ—â–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º                | 9/10 - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ       |

### 4.2. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strangler

1. **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —Å—Ç–∞–¥–∏—è—Ö
2. **Zero downtime**: –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–æ –≤—Ä–µ–º—è –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
3. **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç**: Feature Toggle –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
4. **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**: –ö–∞–Ω–∞—Ä–µ–µ—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (10% ‚Üí 50% ‚Üí 100%) —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫–∏
5. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –ö–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –Ω–æ–≤—ã–º–∏ —Ñ–∏—á–∞–º–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π
6. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–π

### 4.3. –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ —Ä–∏—Å–∫–∏

1. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**: –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ API Gateway –∏ Feature Toggle
2. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–≤—É—Ö –≤–µ—Ä—Å–∏–π**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –º–æ–Ω–æ–ª–∏—Ç–∞ –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
3. **–†–∏—Å–∫ —É—Ç–µ—á–∫–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Å–µ—Ä–≤–∏—Å–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–≤—è–∑–Ω–æ—Å—Ç–∏
4. **–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏–π

### 4.4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Strangler Pattern:**
- –ë–æ–ª—å—à–æ–π –º–æ–Ω–æ–ª–∏—Ç —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
- –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã (—Ñ–∏–Ω—Ç–µ—Ö, —Ç–∞–∫—Å–∏, –º–µ–¥–∏—Ü–∏–Ω–∞)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–∞–ª–∏—á–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ù–µ–±–æ–ª—å—à–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π (–æ–≤–µ—Ä–¥–∏–∑–∞–π–Ω)
- –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–ø—Ä–æ—â–µ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∑–∞–Ω–æ–≤–æ)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è Feature Toggle –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## 5. –í—ã–≤–æ–¥—ã

–ü–∞—Ç—Ç–µ—Ä–Ω Strangler –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∏–∑ –º–æ–Ω–æ–ª–∏—Ç–∞ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –ù–∞ –ø—Ä–∏–º–µ—Ä–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è TariffRouteService –∏–∑ OrderService –≤ —Å–∏—Å—Ç–µ–º–µ –Ø–Ω–¥–µ–∫—Å.–¢–∞–∫—Å–∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥—É –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
2. **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ—Å—Ç–æ—è —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏ (zero downtime)
3. **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ—Å—Ç—å**: A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
4. **–ì–∏–±–∫–æ—Å—Ç—å**: Feature Toggle –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–æ–º
5. **–≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–µ –±–∞–ª–ª—ã (8-10/10) –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

**–ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**  
–ü–∞—Ç—Ç–µ—Ä–Ω Strangler —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–æ–≤ —Å —á–µ—Ç–∫–∏–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏, –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ. –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (API Gateway, Feature Toggle, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥), –Ω–æ –æ–∫—É–ø–∞–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ–º —Ä–∏—Å–∫–æ–≤ –∏ –ø–ª–∞–≤–Ω—ã–º –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ**: REST/HTTP, gRPC
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ**: Apache Kafka, RabbitMQ
- **API Gateway**: Kong, AWS API Gateway, Azure API Management

### –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
- **–†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –ë–î**: PostgreSQL
- **NoSQL**: MongoDB
- **–ö—ç—à**: Redis
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã**: TimescaleDB

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ú–µ—Ç—Ä–∏–∫–∏**: Prometheus, Grafana
- **–¢—Ä–µ–π—Å–∏–Ω–≥**: Jaeger, Zipkin
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: ELK Stack (Elasticsearch, Logstash, Kibana)

### Feature Toggle —Ä–µ—à–µ–Ω–∏—è
- LaunchDarkly
- Unleash
- Azure App Configuration

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 11 –Ω–æ—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0