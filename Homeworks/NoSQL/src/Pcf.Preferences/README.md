# Pcf.Preferences - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Core** - –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **DataAccess** - –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –∫–æ–Ω—Ç–µ–∫—Å—Ç –ë–î –∏ —Å–µ—Ä–≤–∏—Å—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **WebHost** - API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏
- ‚úÖ Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ In-memory –∫—ç—à –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ RESTful API
- ‚úÖ Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üìã API Endpoints

### –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è

- `GET /api/v1/preferences` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
- `GET /api/v1/preferences/{id}` - –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –ø–æ ID
- `POST /api/v1/preferences` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ
- `PUT /api/v1/preferences/{id}` - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ
- `DELETE /api/v1/preferences/{id}` - –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ

## üõ†Ô∏è –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd src/Pcf.Preferences

# –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
dotnet build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å in-memory –∫—ç—à–µ–º
dotnet run --project Pcf.Preferences.WebHost --urls "http://localhost:8094"
```

### Docker

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up

# –ò–ª–∏ —Ç–æ–ª—å–∫–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π
docker-compose up promocode-factory-preferences-api
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### appsettings.json

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=preferences.db",
    "Redis": "localhost:6379"
  },
  "CacheSettings": {
    "UseRedis": false
  }
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `ConnectionStrings:DefaultConnection` - –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- `ConnectionStrings:Redis` - –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- `CacheSettings:UseRedis` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis (true/false)

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite —Å Entity Framework Core. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

- –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
- –û–¥–µ–∂–¥–∞
- –ö–Ω–∏–≥–∏
- –°–ø–æ—Ä—Ç
- –ö—Ä–∞—Å–æ—Ç–∞

## üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### Redis (–ø—Ä–æ–¥–∞–∫—à–Ω)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∫—ç—à
- –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### In-Memory (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- .NET 8.0
- Entity Framework Core
- StackExchange.Redis
- Microsoft.Extensions.Caching.*

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
./test-preferences-api.ps1
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ —á–µ—Ä–µ–∑ HTTP API:

- `GivingToCustomer` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- `ReceivingFromPartner` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –æ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π

```bash
curl -X GET "http://localhost:8094/api/v1/preferences"
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è

```bash
curl -X POST "http://localhost:8094/api/v1/preferences" \
  -H "Content-Type: application/json" \
  -d '{"name": "–ù–æ–≤–æ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ", "description": "–û–ø–∏—Å–∞–Ω–∏–µ"}'
```
